<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cha.notice.mapper.NoticeMapper">
	<!-- 공지 목록 -->
	<!-- <select id="getAllNoticeList" resultType="noticeDTO">
		SELECT * FROM notice ORDER BY noticeId DESC
	</select> -->

	<!-- 공지 상세 -->
	<select id="selectNoticeDetail" resultType="noticeDTO">
		SELECT * FROM notice WHERE noticeId = #{noticeId}
	</select>

	<!-- 조회수 증가 -->
	<update id="updateReadCount">
		UPDATE notice SET readCount = readCount + 1 WHERE noticeId = #{noticeId}
	</update>

	<!-- 공지 등록 -->
	<insert id="insertNotice" parameterType="noticeDTO">
		INSERT INTO notice (userId, title, content, regDate, readCount)
		VALUES (#{userId}, #{title}, #{content}, NOW(), 0)
	</insert>

	<!-- 공지 수정 -->
	<update id="updateNotice" parameterType="noticeDTO">
		UPDATE notice
		SET title = #{title}, content = #{content}, modDate = NOW()
		WHERE noticeId = #{noticeId}
	</update>

	<!-- 공지 삭제 -->
	<delete id="deleteNotice">
		DELETE FROM notice WHERE noticeId = #{noticeId}
	</delete>

	<!-- ======================= 페이징 ======================= -->

	<!-- 전체 공지 개수 -->
	<select id="getAllCount" resultType="int">
		SELECT COUNT(*) FROM notice
	</select>

	<!-- 공지 전체 목록 -->
	<select id="getPageList" resultType="noticeDTO">
		SELECT * FROM notice ORDER BY noticeId DESC LIMIT #{startRow}, #{pageSize}
		<!-- SELECT noticeId, userId, title,content,
        DATE_FORMAT(regDate, '%Y-%m-%d') as regDate, 
        DATE_FORMAT(modDate, '%Y-%m-%d') as modDate, readCount
	    FROM notice 
	    ORDER BY noticeId DESC 
	    LIMIT #{startRow}, #{pageSize} -->
	</select>

</mapper>